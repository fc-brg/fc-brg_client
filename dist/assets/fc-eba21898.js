import{d as a}from"./vendor-55a355ca.js";import{c as t,a as e}from"./admin-e8e59f4a.js";import{f as r}from"./timezone-f19b4e1b.js";const s=t.create({baseURL:"https://fc-online-server.onrender.com",timeout:3e4}),o=a("fc",{state:()=>({users:{},matches:{},matchDetails:{},loading:!1,error:null,userCache:new Map,matchCache:new Map,matchDetailCache:new Map}),actions:{delay:async a=>new Promise(t=>setTimeout(t,a)),getFromCache(a,t){const e=a.get(t);return e&&Date.now()-e.timestamp<3e5?e.data:null},setToCache(a,t,e){a.set(t,{data:e,timestamp:Date.now()})},async fetchUsers(a){this.loading=!0,this.error=null;try{console.log("사용자 정보 조회 시작:",a);const t=await s.post("/api/fc/users",{nicknames:a});if(console.log("사용자 정보 조회 응답:",t.data),t.data.success)return t.data.data.forEach(a=>{if(a.error)console.warn("사용자 정보 조회 실패:",{userName:a.userName||a.nickName,error:a.error});else{const t=a.userName||a.nickName;t?this.users[t]=a:console.warn("사용자 이름 필드 없음:",a)}}),t.data;throw new Error("사용자 정보 조회 실패")}catch(t){throw this.error=t.message,console.error("사용자 정보 조회 실패:",t),t}finally{this.loading=!1}},async fetchMatches(a,t=!1,s=50,o=50){this.loading=!0,this.error=null;try{console.log("매치 데이터 요청:",{ouid:a,refresh:t,matchtype:s,limit:o});const c=await e.get(`/api/fc/matches/${a}`,{params:{refresh:t.toString(),matchtype:s.toString(),limit:o.toString()}});if(console.log("매치 데이터 응답:",c.data),c.data.success){const t=c.data.data.map(a=>({...a,matchDateDisplay:r(a.matchDate,"datetime")})).sort((a,t)=>new Date(t.matchDate).getTime()-new Date(a.matchDate).getTime());return this.matches[a]=t,{...c.data,data:t}}throw new Error(c.data.error||"매치 데이터 조회 실패")}catch(c){throw console.error("매치 데이터 조회 오류:",c),this.error=c.message,c}finally{this.loading=!1}},async fetchMatchDetail(a){this.loading=!0,this.error=null;try{const t=await s.get(`/api/fc/match-detail/${a}`);if(t.data.success)return t.data.data}catch(t){this.error=t.message,console.error("매치 상세 정보 조회 실패:",t)}finally{this.loading=!1}},async fetchPlayerStats(a){try{const t=await s.get(`/api/player-stats/${a}`);if(t.data.success)return t.data.data;throw new Error(t.data.error||"선수별 득점 통계 조회 실패")}catch(t){throw console.error("선수별 득점 통계 조회 실패:",t),t}}}});export{o as u};
